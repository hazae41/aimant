{"version":3,"file":"signature.cjs","sources":["../../../../src/mods/binary/signature.ts"],"sourcesContent":["import { Binary } from \"libs/binary.js\";\nimport { Number16 } from \"mods/binary/number.js\";\nimport { BufferVector, Vector } from \"mods/binary/vector.js\";\n\nexport class HashAlgorithm {\n  readonly class = HashAlgorithm\n\n  static types = {\n    none: 0,\n    md5: 1,\n    sha1: 2,\n    sha224: 3,\n    sha256: 4,\n    sha384: 5,\n    sha512: 6,\n  }\n\n  constructor(\n    readonly type: number\n  ) { }\n\n  size() {\n    return 1\n  }\n\n  write(binary: Binary) {\n    binary.writeUint8(this.type)\n  }\n\n  static read(binary: Binary) {\n    return new this(binary.readUint8())\n  }\n}\n\nexport class SignatureAlgorithm {\n  readonly class = SignatureAlgorithm\n\n  static types = {\n    anonymous: 0,\n    rsa: 1,\n    dsa: 2,\n    ecdsa: 3\n  }\n\n  constructor(\n    readonly type: number\n  ) { }\n\n  size() {\n    return 1\n  }\n\n  write(binary: Binary) {\n    binary.writeUint8(this.type)\n  }\n\n  static read(binary: Binary) {\n    return new this(binary.readUint8())\n  }\n}\n\nexport class SignatureAndHashAlgorithm {\n  readonly class = SignatureAndHashAlgorithm\n\n  constructor(\n    readonly hash: HashAlgorithm,\n    readonly signature: SignatureAlgorithm\n  ) { }\n\n  size() {\n    return this.hash.size() + this.signature.size()\n  }\n\n  write(binary: Binary) {\n    this.hash.write(binary)\n    this.signature.write(binary)\n  }\n\n  static read(binary: Binary) {\n    const hash = HashAlgorithm.read(binary)\n    const signature = SignatureAlgorithm.read(binary)\n\n    return new this(hash, signature)\n  }\n}\n\nexport class DigitallySigned {\n  readonly class = DigitallySigned\n\n  constructor(\n    readonly algorithm: SignatureAndHashAlgorithm,\n    readonly signature: Vector<Number16>\n  ) { }\n\n  size() {\n    return this.algorithm.size() + this.signature.size()\n  }\n\n  write(binary: Binary) {\n    this.algorithm.write(binary)\n    this.signature.write(binary)\n  }\n\n  static read(binary: Binary) {\n    const algorithm = SignatureAndHashAlgorithm.read(binary)\n    const signature = BufferVector<Number16>(Number16).read(binary)\n\n    return new this(algorithm, signature)\n  }\n}"],"names":["BufferVector","Number16"],"mappings":"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"}