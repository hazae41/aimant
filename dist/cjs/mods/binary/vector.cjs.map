{"version":3,"file":"vector.cjs","sources":["../../../../src/mods/binary/vector.ts"],"sourcesContent":["import { Binary } from \"libs/binary.js\";\nimport { NumberX } from \"mods/binary/number.js\";\nimport { Writable } from \"mods/binary/writable.js\";\n\nexport interface Vector<L extends NumberX = any> extends Writable {\n  readonly length: L[\"class\"]\n}\n\nexport class BufferVector<L extends NumberX = any> {\n  readonly class = BufferVector<L>\n\n  constructor(\n    readonly buffer: Buffer,\n    readonly length: L[\"class\"],\n  ) { }\n\n  static empty<L extends NumberX = any>(length: L[\"class\"]) {\n    return new this(Buffer.allocUnsafe(0), length)\n  }\n\n  size() {\n    return this.length.size + this.buffer.length\n  }\n\n  write(binary: Binary) {\n    new this.length(this.buffer.length).write(binary)\n\n    binary.write(this.buffer)\n  }\n}\n\nexport class AnyVector<L extends NumberX = any, T extends Writable = any> {\n  readonly class = AnyVector<L>\n\n  constructor(\n    readonly value: T,\n    readonly length: L[\"class\"],\n  ) { }\n\n  size() {\n    return this.length.size + this.value.size()\n  }\n\n  write(binary: Binary) {\n    new this.length(this.value.size()).write(binary)\n\n    this.value.write(binary)\n  }\n}\n\nexport class ArrayVector<L extends NumberX = any, T extends Writable = any> {\n  readonly class = ArrayVector<L, T>\n\n  constructor(\n    readonly array: T[],\n    readonly length: L[\"class\"],\n  ) { }\n\n  size() {\n    let size = this.length.size\n\n    for (const element of this.array)\n      size += element.size()\n\n    return size\n  }\n\n  write(binary: Binary) {\n    let size = 0\n\n    for (const element of this.array)\n      size += element.size()\n\n    new this.length(size).write(binary)\n\n    for (const element of this.array)\n      element.write(binary)\n  }\n}\n\nexport class Vector8<L extends NumberX = any> {\n  readonly class = Vector8<L>\n\n  constructor(\n    readonly array: number[],\n    readonly length: L[\"class\"],\n  ) { }\n\n  size() {\n    return this.length.size + this.array.length\n  }\n\n  write(binary: Binary) {\n    new this.length(this.array.length).write(binary)\n\n    for (const element of this.array)\n      binary.writeUint8(element)\n  }\n}\n\nexport class Vector16<L extends NumberX = any> {\n  readonly class = Vector16<L>\n\n  constructor(\n    readonly array: number[],\n    readonly length: L[\"class\"],\n  ) { }\n\n  size() {\n    return this.length.size + (this.array.length * 2)\n  }\n\n  write(binary: Binary) {\n    new this.length(this.array.length * 2).write(binary)\n\n    for (const element of this.array)\n      binary.writeUint16(element)\n  }\n}"],"names":[],"mappings":"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"}