{"version":3,"file":"vector.cjs","sources":["../../../../src/mods/binary/vector.ts"],"sourcesContent":["import { Binary } from \"libs/binary.js\";\n\nexport interface Writable {\n  size(): number\n  write(binary: Binary): void\n}\n\nexport class Opaque {\n  readonly class = Opaque\n\n  constructor(\n    readonly buffer: Buffer\n  ) { }\n\n  size() {\n    return this.buffer.length\n  }\n\n  write(binary: Binary) {\n    binary.write(this.buffer)\n  }\n}\n\nexport type NumberX =\n  | Number8\n  | Number16\n\nexport class Number8 {\n  readonly class = Number8\n\n  constructor(\n    readonly length: number\n  ) { }\n\n  size() {\n    return 1\n  }\n\n  write(binary: Binary) {\n    binary.writeUint8(this.length)\n  }\n}\n\nexport class Number16 {\n  readonly class = Number16\n\n  constructor(\n    readonly length: number\n  ) { }\n\n  size() {\n    return 2\n  }\n\n  write(binary: Binary) {\n    binary.writeUint16(this.length)\n  }\n}\n\nexport class Vector<T extends Writable> {\n  readonly class = Vector<T>\n\n  constructor(\n    readonly array: T[],\n    readonly length: NumberX[\"class\"],\n  ) { }\n\n  size() {\n    let size = new this.length(this.array.length).size()\n\n    for (const element of this.array)\n      size += element.size()\n\n    return size\n  }\n\n  write(binary: Binary) {\n    new this.length(this.array.length).write(binary)\n\n    for (const element of this.array)\n      element.write(binary)\n  }\n}"],"names":[],"mappings":";;MAOa,MAAM,CAAA;AAGjB,IAAA,WAAA,CACW,MAAc,EAAA;QAAd,IAAM,CAAA,MAAA,GAAN,MAAM,CAAQ;QAHhB,IAAK,CAAA,KAAA,GAAG,MAAM,CAAA;KAIlB;IAEL,IAAI,GAAA;AACF,QAAA,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAA;KAC1B;AAED,IAAA,KAAK,CAAC,MAAc,EAAA;AAClB,QAAA,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;KAC1B;AACF,CAAA;MAMY,OAAO,CAAA;AAGlB,IAAA,WAAA,CACW,MAAc,EAAA;QAAd,IAAM,CAAA,MAAA,GAAN,MAAM,CAAQ;QAHhB,IAAK,CAAA,KAAA,GAAG,OAAO,CAAA;KAInB;IAEL,IAAI,GAAA;AACF,QAAA,OAAO,CAAC,CAAA;KACT;AAED,IAAA,KAAK,CAAC,MAAc,EAAA;AAClB,QAAA,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;KAC/B;AACF,CAAA;MAEY,QAAQ,CAAA;AAGnB,IAAA,WAAA,CACW,MAAc,EAAA;QAAd,IAAM,CAAA,MAAA,GAAN,MAAM,CAAQ;QAHhB,IAAK,CAAA,KAAA,GAAG,QAAQ,CAAA;KAIpB;IAEL,IAAI,GAAA;AACF,QAAA,OAAO,CAAC,CAAA;KACT;AAED,IAAA,KAAK,CAAC,MAAc,EAAA;AAClB,QAAA,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;KAChC;AACF,CAAA;MAEY,MAAM,CAAA;IAGjB,WACW,CAAA,KAAU,EACV,MAAwB,EAAA;QADxB,IAAK,CAAA,KAAA,GAAL,KAAK,CAAK;QACV,IAAM,CAAA,MAAA,GAAN,MAAM,CAAkB;QAJ1B,IAAK,CAAA,KAAA,IAAG,MAAS,CAAA,CAAA;KAKrB;IAEL,IAAI,GAAA;AACF,QAAA,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,CAAA;AAEpD,QAAA,KAAK,MAAM,OAAO,IAAI,IAAI,CAAC,KAAK;AAC9B,YAAA,IAAI,IAAI,OAAO,CAAC,IAAI,EAAE,CAAA;AAExB,QAAA,OAAO,IAAI,CAAA;KACZ;AAED,IAAA,KAAK,CAAC,MAAc,EAAA;AAClB,QAAA,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;AAEhD,QAAA,KAAK,MAAM,OAAO,IAAI,IAAI,CAAC,KAAK;AAC9B,YAAA,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;KACxB;AACF;;;;;;;"}