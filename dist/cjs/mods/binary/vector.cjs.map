{"version":3,"file":"vector.cjs","sources":["../../../../src/mods/binary/vector.ts"],"sourcesContent":["import { Binary } from \"libs/binary.js\";\n\nexport interface Writable {\n  size(): number\n  write(binary: Binary): void\n}\n\nexport class Opaque {\n  readonly class = Opaque\n\n  constructor(\n    readonly buffer: Buffer\n  ) { }\n\n  size() {\n    return this.buffer.length\n  }\n\n  write(binary: Binary) {\n    binary.write(this.buffer)\n  }\n}\n\nexport type NumberX =\n  | Number8\n  | Number16\n\nexport class Number8 {\n  readonly class = Number8\n\n  static size: 1 = 1\n\n  constructor(\n    readonly length: number\n  ) { }\n\n  size() {\n    return 1\n  }\n\n  write(binary: Binary) {\n    binary.writeUint8(this.length)\n  }\n}\n\nexport class Number16 {\n  readonly class = Number16\n\n  static size: 2 = 2\n\n  constructor(\n    readonly length: number\n  ) { }\n\n  size() {\n    return 2\n  }\n\n  write(binary: Binary) {\n    binary.writeUint16(this.length)\n  }\n}\n\nexport class Vector<L extends NumberX = any, T extends Writable = any> {\n  readonly class = Vector<L, T>\n\n  constructor(\n    readonly array: T[],\n    readonly length: L[\"class\"],\n  ) { }\n\n  size() {\n    let size = new this.length(this.array.length).size()\n\n    for (const element of this.array)\n      size += element.size()\n\n    return size\n  }\n\n  write(binary: Binary) {\n    new this.length(this.array.length).write(binary)\n\n    for (const element of this.array)\n      element.write(binary)\n  }\n}\n\nexport class Vector8<L extends NumberX = any> {\n  readonly class = Vector8<L>\n\n  constructor(\n    readonly array: number[],\n    readonly length: L[\"class\"],\n  ) { }\n\n  size() {\n    return new this.length(this.array.length).size() + this.array.length\n  }\n\n  write(binary: Binary) {\n    new this.length(this.array.length).write(binary)\n\n    for (const element of this.array)\n      binary.writeUint8(element)\n  }\n}\n\nexport class Vector16<L extends NumberX = any> {\n  readonly class = Vector16<L>\n\n  constructor(\n    readonly array: number[],\n    readonly length: L[\"class\"],\n  ) { }\n\n  size() {\n    return new this.length(this.array.length).size() + (this.array.length * 2)\n  }\n\n  write(binary: Binary) {\n    new this.length(this.array.length).write(binary)\n\n    for (const element of this.array)\n      binary.writeUint16(element)\n  }\n}\n\nexport class OpaqueVector<L extends NumberX = any> {\n  readonly class = OpaqueVector<L>\n\n  constructor(\n    readonly buffer: Buffer,\n    readonly length: L[\"class\"],\n  ) { }\n\n  static empty<L extends NumberX = any>(length: L[\"class\"]) {\n    return new this(Buffer.allocUnsafe(0), length)\n  }\n\n  size() {\n    return new this.length(this.buffer.length).size() + this.buffer.length\n  }\n\n  write(binary: Binary) {\n    new this.length(this.buffer.length).write(binary)\n\n    binary.write(this.buffer)\n  }\n}"],"names":[],"mappings":"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"}