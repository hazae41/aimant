{"version":3,"file":"client_hello.cjs","sources":["../../../../src/mods/binary/client_hello.ts"],"sourcesContent":["import { Binary } from \"libs/binary.js\"\nimport { generateRandom } from \"libs/random.js\"\nimport { Number16, Number8, Vector } from \"./vector.js\"\n\nexport class ClientHello {\n  readonly class = ClientHello\n\n  constructor(\n    readonly legacy_version = 0x0303,\n    readonly random = generateRandom(32),\n    readonly legacy_session_id = new Vector([], Number8),\n    readonly cipher_suites = new Vector([new Number16(0xC02F), new Number16(0xC02F)], Number16),\n    readonly legacy_compression_methods = new Vector([new Number8(0)], Number8),\n    readonly extensions = new Vector([], Number16)\n  ) { }\n\n  size() {\n    return 0\n      + 2\n      + this.random.length\n      + this.legacy_session_id.size()\n      + this.cipher_suites.size()\n      + this.legacy_compression_methods.size()\n      + this.extensions.size()\n  }\n\n  write(binary: Binary) {\n    binary.writeUint16(this.legacy_version)\n    binary.write(this.random)\n    this.legacy_session_id.write(binary)\n    this.cipher_suites.write(binary)\n    this.legacy_compression_methods.write(binary)\n    this.extensions.write(binary)\n  }\n\n  export() {\n    const binary = Binary.allocUnsafe(this.size())\n\n    this.write(binary)\n\n    return binary\n  }\n}"],"names":["random","generateRandom","Vector","Number8","Number16","binary","Binary"],"mappings":";;;;;;MAIa,WAAW,CAAA;AAGtB,IAAA,WAAA,CACW,cAAiB,GAAA,MAAM,EACvBA,QAAA,GAASC,qBAAc,CAAC,EAAE,CAAC,EAC3B,iBAAA,GAAoB,IAAIC,aAAM,CAAC,EAAE,EAAEC,cAAO,CAAC,EAC3C,aAAgB,GAAA,IAAID,aAAM,CAAC,CAAC,IAAIE,eAAQ,CAAC,MAAM,CAAC,EAAE,IAAIA,eAAQ,CAAC,MAAM,CAAC,CAAC,EAAEA,eAAQ,CAAC,EAClF,0BAAA,GAA6B,IAAIF,aAAM,CAAC,CAAC,IAAIC,cAAO,CAAC,CAAC,CAAC,CAAC,EAAEA,cAAO,CAAC,EAClE,UAAa,GAAA,IAAID,aAAM,CAAC,EAAE,EAAEE,eAAQ,CAAC,EAAA;QALrC,IAAc,CAAA,cAAA,GAAd,cAAc,CAAS;QACvB,IAAM,CAAA,MAAA,GAANJ,QAAM,CAAqB;QAC3B,IAAiB,CAAA,iBAAA,GAAjB,iBAAiB,CAA0B;QAC3C,IAAa,CAAA,aAAA,GAAb,aAAa,CAAqE;QAClF,IAA0B,CAAA,0BAAA,GAA1B,0BAA0B,CAAwC;QAClE,IAAU,CAAA,UAAA,GAAV,UAAU,CAA2B;QARvC,IAAK,CAAA,KAAA,GAAG,WAAW,CAAA;KASvB;IAEL,IAAI,GAAA;AACF,QAAA,OAAO,CAAC;cACJ,CAAC;cACD,IAAI,CAAC,MAAM,CAAC,MAAM;AAClB,cAAA,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE;AAC7B,cAAA,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE;AACzB,cAAA,IAAI,CAAC,0BAA0B,CAAC,IAAI,EAAE;AACtC,cAAA,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,CAAA;KAC3B;AAED,IAAA,KAAK,CAAC,MAAc,EAAA;AAClB,QAAA,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,cAAc,CAAC,CAAA;AACvC,QAAA,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;AACzB,QAAA,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;AACpC,QAAA,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;AAChC,QAAA,IAAI,CAAC,0BAA0B,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;AAC7C,QAAA,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;KAC9B;IAED,MAAM,GAAA;QACJ,MAAMK,QAAM,GAAGC,aAAM,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAA;AAE9C,QAAA,IAAI,CAAC,KAAK,CAACD,QAAM,CAAC,CAAA;AAElB,QAAA,OAAOA,QAAM,CAAA;KACd;AACF;;;;"}