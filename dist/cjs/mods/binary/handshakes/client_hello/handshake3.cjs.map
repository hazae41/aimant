{"version":3,"file":"handshake3.cjs","sources":["../../../../../../src/mods/binary/handshakes/client_hello/handshake3.ts"],"sourcesContent":["import { Binary } from \"libs/binary.js\"\nimport { generateRandom } from \"libs/random.js\"\nimport { ClientSupportedVersions } from \"mods/binary/extensions/supported_versions/extension.js\"\nimport { Handshake } from \"mods/binary/handshakes/handshake.js\"\nimport { Number16, Number8 } from \"mods/binary/number.js\"\nimport { ArrayVector, Vector, Vector16, Vector8 } from \"mods/binary/vector.js\"\n\nexport class ClientHello3 {\n  readonly class = ClientHello3\n\n  static type = Handshake.types.client_hello\n\n  constructor(\n    readonly legacy_version: number,\n    readonly random: Buffer,\n    readonly legacy_session_id: Vector<Number8>,\n    readonly cipher_suites: Vector<Number16>,\n    readonly legacy_compression_methods: Vector<Number8>,\n    readonly extensions: Vector<Number16>\n  ) { }\n\n  get type() {\n    return this.class.type\n  }\n\n  static default(ciphers: number[]) {\n    const legacy_version = 0x0303\n    const random = generateRandom(32)\n\n    const legacy_session_id = new ArrayVector<Number8>([], Number8)\n    const cipher_suites = new (Vector16<Number16>(Number16))(ciphers)\n    const legacy_compression_methods = new Vector8<Number8>([0], Number8)\n    const extensions = new ArrayVector<Number16>([ClientSupportedVersions.default3().extension()], Number16)\n\n    return new this(legacy_version, random, legacy_session_id, cipher_suites, legacy_compression_methods, extensions)\n  }\n\n  size() {\n    return 0\n      + 2\n      + this.random.length\n      + this.legacy_session_id.size()\n      + this.cipher_suites.size()\n      + this.legacy_compression_methods.size()\n      + this.extensions.size()\n  }\n\n  write(binary: Binary) {\n    binary.writeUint16(this.legacy_version)\n    binary.write(this.random)\n    this.legacy_session_id.write(binary)\n    this.cipher_suites.write(binary)\n    this.legacy_compression_methods.write(binary)\n    this.extensions.write(binary)\n  }\n\n  handshake() {\n    return Handshake.from(this)\n  }\n}"],"names":["random","generateRandom","ArrayVector","Number8","Vector16","Number16","Vector8","ClientSupportedVersions","Handshake"],"mappings":";;;;;;;;MAOa,YAAY,CAAA;IAKvB,WACW,CAAA,cAAsB,EACtB,MAAc,EACd,iBAAkC,EAClC,aAA+B,EAC/B,0BAA2C,EAC3C,UAA4B,EAAA;QAL5B,IAAc,CAAA,cAAA,GAAd,cAAc,CAAQ;QACtB,IAAM,CAAA,MAAA,GAAN,MAAM,CAAQ;QACd,IAAiB,CAAA,iBAAA,GAAjB,iBAAiB,CAAiB;QAClC,IAAa,CAAA,aAAA,GAAb,aAAa,CAAkB;QAC/B,IAA0B,CAAA,0BAAA,GAA1B,0BAA0B,CAAiB;QAC3C,IAAU,CAAA,UAAA,GAAV,UAAU,CAAkB;QAV9B,IAAK,CAAA,KAAA,GAAG,YAAY,CAAA;KAWxB;AAEL,IAAA,IAAI,IAAI,GAAA;AACN,QAAA,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAA;KACvB;IAED,OAAO,OAAO,CAAC,OAAiB,EAAA;QAC9B,MAAM,cAAc,GAAG,MAAM,CAAA;AAC7B,QAAA,MAAMA,QAAM,GAAGC,qBAAc,CAAC,EAAE,CAAC,CAAA;QAEjC,MAAM,iBAAiB,GAAG,IAAIC,kBAAW,CAAU,EAAE,EAAEC,cAAO,CAAC,CAAA;AAC/D,QAAA,MAAM,aAAa,GAAG,KAAKC,eAAQ,CAAWC,eAAQ,CAAC,EAAE,OAAO,CAAC,CAAA;QACjE,MAAM,0BAA0B,GAAG,IAAIC,cAAO,CAAU,CAAC,CAAC,CAAC,EAAEH,cAAO,CAAC,CAAA;AACrE,QAAA,MAAM,UAAU,GAAG,IAAID,kBAAW,CAAW,CAACK,iCAAuB,CAAC,QAAQ,EAAE,CAAC,SAAS,EAAE,CAAC,EAAEF,eAAQ,CAAC,CAAA;AAExG,QAAA,OAAO,IAAI,IAAI,CAAC,cAAc,EAAEL,QAAM,EAAE,iBAAiB,EAAE,aAAa,EAAE,0BAA0B,EAAE,UAAU,CAAC,CAAA;KAClH;IAED,IAAI,GAAA;AACF,QAAA,OAAO,CAAC;cACJ,CAAC;cACD,IAAI,CAAC,MAAM,CAAC,MAAM;AAClB,cAAA,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE;AAC7B,cAAA,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE;AACzB,cAAA,IAAI,CAAC,0BAA0B,CAAC,IAAI,EAAE;AACtC,cAAA,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,CAAA;KAC3B;AAED,IAAA,KAAK,CAAC,MAAc,EAAA;AAClB,QAAA,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,cAAc,CAAC,CAAA;AACvC,QAAA,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;AACzB,QAAA,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;AACpC,QAAA,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;AAChC,QAAA,IAAI,CAAC,0BAA0B,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;AAC7C,QAAA,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;KAC9B;IAED,SAAS,GAAA;AACP,QAAA,OAAOQ,mBAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;KAC5B;;AAhDM,YAAA,CAAA,IAAI,GAAGA,mBAAS,CAAC,KAAK,CAAC,YAAY;;;;"}