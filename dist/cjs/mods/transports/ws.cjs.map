{"version":3,"file":"ws.cjs","sources":["../../../../src/mods/transports/ws.ts"],"sourcesContent":["import { Transport } from \"mods/transports/transport.js\"\n\nexport class WebSocketTransport extends EventTarget implements Transport {\n  readonly class = WebSocketTransport\n\n  constructor(\n    readonly socket: WebSocket\n  ) {\n    super()\n\n    socket.addEventListener(\"message\", async (e: MessageEvent<Blob>) => {\n      const data = Buffer.from(await e.data.arrayBuffer())\n      this.dispatchEvent(new MessageEvent(\"message\", { data }))\n    }, { passive: true })\n  }\n\n  send(data: Buffer) {\n    console.log(\"->\", data)\n    this.socket.send(data)\n  }\n}\n"],"names":["__awaiter"],"mappings":";;;;AAEM,MAAO,kBAAmB,SAAQ,WAAW,CAAA;AAGjD,IAAA,WAAA,CACW,MAAiB,EAAA;AAE1B,QAAA,KAAK,EAAE,CAAA;QAFE,IAAM,CAAA,MAAA,GAAN,MAAM,CAAW;QAHnB,IAAK,CAAA,KAAA,GAAG,kBAAkB,CAAA;QAOjC,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,CAAO,CAAqB,KAAIA,eAAA,CAAA,IAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,aAAA;AACjE,YAAA,MAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,CAAA;AACpD,YAAA,IAAI,CAAC,aAAa,CAAC,IAAI,YAAY,CAAC,SAAS,EAAE,EAAE,IAAI,EAAE,CAAC,CAAC,CAAA;SAC1D,CAAA,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAA;KACtB;AAED,IAAA,IAAI,CAAC,IAAY,EAAA;AACf,QAAA,OAAO,CAAC,GAAG,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;AACvB,QAAA,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;KACvB;AACF;;;;"}